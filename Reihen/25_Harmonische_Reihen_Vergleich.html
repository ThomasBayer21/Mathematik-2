<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmonische Reihen und Vergleich</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e8daf0 0%, #d4cce0 100%);
            padding: 20px;
            min-height: 100vh;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        .description {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .example-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .example-btn {
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            padding: 12px;
            font-size: 13px;
            transition: background 0.3s;
        }
        .example-btn:hover {
            background: #1e40af;
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 20px;
        }
        .control-group {
            display: flex;
            flex-direction: column;
        }
        label {
            margin-bottom: 10px;
            font-weight: bold;
            color: #34495e;
        }
        input[type="range"] {
            width: 100%;
            margin-top: 8px;
        }
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-weight: normal;
        }
        canvas {
            border: 2px solid #2563eb;
            border-radius: 5px;
            display: block;
            margin: 20px auto;
            background: white;
            max-width: 100%;
        }
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }
        .legend-box {
            width: 20px;
            height: 3px;
            border-radius: 2px;
        }
        .info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .info h3 {
            margin-top: 0;
            color: #2563eb;
        }
        .series-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .series-card {
            background: white;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .series-card h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        .series-card .formula {
            font-family: 'Courier New', monospace;
            color: #2563eb;
            margin: 5px 0;
        }
        .series-card .status {
            margin-top: 10px;
            font-weight: bold;
        }
        .convergent {
            color: #27ae60;
        }
        .divergent {
            color: #e74c3c;
        }
        .interpretation {
            background: #f8fafc;
            padding: 15px;
            border-left: 3px solid #e2e8f0;
            margin: 15px 0;
            border-radius: 3px;
        }
        .interpretation h3 {
            margin-top: 0;
            color: #64748b;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Harmonische Reihen und Vergleich</h1>

        <div class="description">
            <p><strong>Vergleich verschiedener Reihen</strong> und deren Konvergenzverhalten</p>
            <p>Beobachte, wie unterschiedlich schnell verschiedene Reihen konvergieren oder divergieren</p>
        </div>

        <div class="example-buttons">
            <button class="example-btn" onclick="loadExample('all')">Alle Reihen</button>
            <button class="example-btn" onclick="loadExample('harmonic')">Harmonische</button>
            <button class="example-btn" onclick="loadExample('p-series')">p-Reihen</button>
            <button class="example-btn" onclick="loadExample('factorial')">Fakultät</button>
            <button class="example-btn" onclick="loadExample('convergent')">Nur konvergente</button>
            <button class="example-btn" onclick="loadExample('divergent')">Nur divergente</button>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>Anzahl Terme n: <span id="nValue">50</span></label>
                <input type="range" id="n" min="10" max="200" value="50">
            </div>

            <div class="control-group">
                <label>y-Achsen Skalierung: <span id="scaleValue">Auto</span></label>
                <input type="range" id="scale" min="1" max="50" value="0">
            </div>
        </div>

        <h3 style="color: #2c3e50; margin: 20px 0 10px 0;">Reihen auswählen:</h3>
        <div class="checkbox-group">
            <div class="checkbox-item">
                <input type="checkbox" id="show_harmonic" checked>
                <label for="show_harmonic">Harmonische Reihe ∑1/n</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="show_alt_harmonic" checked>
                <label for="show_alt_harmonic">Alt. harmonische ∑(-1)ⁿ/n</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="show_p2" checked>
                <label for="show_p2">p-Reihe ∑1/n²</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="show_p3" checked>
                <label for="show_p3">p-Reihe ∑1/n³</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="show_p05" checked>
                <label for="show_p05">p-Reihe ∑1/√n</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="show_exp" checked>
                <label for="show_exp">∑1/n!</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="show_n2n" checked>
                <label for="show_n2n">∑n/2ⁿ</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="show_ln" checked>
                <label for="show_ln">∑1/(n·ln(n))</label>
            </div>
        </div>

        <div class="legend" id="legendContainer"></div>

        <canvas id="canvas" width="1100" height="600"></canvas>

        <div class="info">
            <h3>Reihen-Übersicht</h3>
            <div class="series-info">
                <div class="series-card">
                    <h4>Harmonische Reihe</h4>
                    <div class="formula">∑(n=1 bis ∞) 1/n</div>
                    <div class="status divergent">Divergent</div>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">Wächst langsam, aber unbegrenzt: ~ ln(n)</p>
                </div>
                <div class="series-card">
                    <h4>Alternierende harmonische</h4>
                    <div class="formula">∑(n=1 bis ∞) (-1)ⁿ⁺¹/n</div>
                    <div class="status convergent">Konvergent → ln(2) ≈ 0.693</div>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">Leibniz-Kriterium</p>
                </div>
                <div class="series-card">
                    <h4>p-Reihe (p=2)</h4>
                    <div class="formula">∑(n=1 bis ∞) 1/n²</div>
                    <div class="status convergent">Konvergent → π²/6 ≈ 1.645</div>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">Basel-Problem</p>
                </div>
                <div class="series-card">
                    <h4>p-Reihe (p=3)</h4>
                    <div class="formula">∑(n=1 bis ∞) 1/n³</div>
                    <div class="status convergent">Konvergent → ζ(3) ≈ 1.202</div>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">Apéry-Konstante</p>
                </div>
                <div class="series-card">
                    <h4>p-Reihe (p=0.5)</h4>
                    <div class="formula">∑(n=1 bis ∞) 1/√n</div>
                    <div class="status divergent">Divergent</div>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">p ≤ 1 → divergent</p>
                </div>
                <div class="series-card">
                    <h4>Fakultät-Reihe</h4>
                    <div class="formula">∑(n=0 bis ∞) 1/n!</div>
                    <div class="status convergent">Konvergent → e ≈ 2.718</div>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">Euler-Zahl</p>
                </div>
                <div class="series-card">
                    <h4>n/2ⁿ</h4>
                    <div class="formula">∑(n=1 bis ∞) n/2ⁿ</div>
                    <div class="status convergent">Konvergent → 2</div>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">Quotientenkriterium</p>
                </div>
                <div class="series-card">
                    <h4>1/(n·ln(n))</h4>
                    <div class="formula">∑(n=2 bis ∞) 1/(n·ln(n))</div>
                    <div class="status divergent">Divergent</div>
                    <p style="margin: 5px 0 0 0; font-size: 12px;">Integralkriterium</p>
                </div>
            </div>
        </div>

        <div class="interpretation">
            <h3>Interpretation</h3>
            <p id="interpretation">
                Die verschiedenen Reihen zeigen unterschiedliches Konvergenzverhalten.
                <strong>p-Reihen</strong> konvergieren für p > 1 und divergieren für p ≤ 1.
                Die <strong>harmonische Reihe</strong> (p=1) ist der Grenzfall: Sie divergiert, aber sehr langsam.
            </p>
        </div>

        <div style="text-align: center; margin-top: 30px;">
            <a href="index.html" style="color: #3498db; text-decoration: none; font-weight: 500;">← Zurück zur Übersicht</a>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        const nSlider = document.getElementById('n');
        const scaleSlider = document.getElementById('scale');
        const nValue = document.getElementById('nValue');
        const scaleValue = document.getElementById('scaleValue');

        const series = {
            harmonic: {
                name: 'Harmonische Reihe',
                color: '#e74c3c',
                term: (n) => 1 / n,
                limit: null,
                divergent: true
            },
            alt_harmonic: {
                name: 'Alternierende harmonische',
                color: '#9b59b6',
                term: (n) => Math.pow(-1, n + 1) / n,
                limit: Math.log(2),
                divergent: false
            },
            p2: {
                name: '∑1/n² (Basel)',
                color: '#3498db',
                term: (n) => 1 / (n * n),
                limit: Math.PI * Math.PI / 6,
                divergent: false
            },
            p3: {
                name: '∑1/n³ (Apéry)',
                color: '#1abc9c',
                term: (n) => 1 / (n * n * n),
                limit: 1.202,
                divergent: false
            },
            p05: {
                name: '∑1/√n',
                color: '#e67e22',
                term: (n) => 1 / Math.sqrt(n),
                limit: null,
                divergent: true
            },
            exp: {
                name: '∑1/n! (e)',
                color: '#27ae60',
                term: (n) => 1 / factorial(n),
                limit: Math.E,
                divergent: false
            },
            n2n: {
                name: '∑n/2ⁿ',
                color: '#f39c12',
                term: (n) => n / Math.pow(2, n),
                limit: 2,
                divergent: false
            },
            ln: {
                name: '∑1/(n·ln(n))',
                color: '#34495e',
                term: (n) => n > 1 ? 1 / (n * Math.log(n)) : 0,
                limit: null,
                divergent: true
            }
        };

        function factorial(n) {
            if (n <= 1) return 1;
            let result = 1;
            for (let i = 2; i <= n; i++) {
                result *= i;
            }
            return result;
        }

        function partialSum(seriesKey, n) {
            let sum = 0;
            const startN = seriesKey === 'ln' ? 2 : (seriesKey === 'exp' ? 0 : 1);
            for (let i = startN; i <= n; i++) {
                sum += series[seriesKey].term(i);
            }
            return sum;
        }

        function toCanvasX(x, xMax) {
            const paddingLeft = 100;
            const paddingRight = 50;
            const width = canvas.width - paddingLeft - paddingRight;
            return paddingLeft + (x / xMax) * width;
        }

        function toCanvasY(y, yMin, yMax) {
            const paddingTop = 40;
            const paddingBottom = 60;
            const height = canvas.height - paddingTop - paddingBottom;
            return canvas.height - paddingBottom - (y - yMin) / (yMax - yMin) * height;
        }

        function drawAxes(xMax, yMin, yMax) {
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 2;

            // X-Achse
            ctx.beginPath();
            ctx.moveTo(toCanvasX(0, xMax), toCanvasY(0, yMin, yMax));
            ctx.lineTo(toCanvasX(xMax, xMax), toCanvasY(0, yMin, yMax));
            ctx.stroke();

            // Y-Achse
            ctx.beginPath();
            ctx.moveTo(toCanvasX(0, xMax), toCanvasY(yMin, yMin, yMax));
            ctx.lineTo(toCanvasX(0, xMax), toCanvasY(yMax, yMin, yMax));
            ctx.stroke();

            // Labels
            ctx.fillStyle = '#2c3e50';
            ctx.font = '14px Arial';
            ctx.fillText('n', toCanvasX(xMax, xMax) + 10, toCanvasY(0, yMin, yMax) + 5);
            ctx.fillText('Sₙ', 20, toCanvasY(yMax, yMin, yMax) - 10);

            // Grid
            ctx.strokeStyle = '#ecf0f1';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const y = yMin + (yMax - yMin) * i / 10;
                ctx.beginPath();
                ctx.moveTo(toCanvasX(0, xMax), toCanvasY(y, yMin, yMax));
                ctx.lineTo(toCanvasX(xMax, xMax), toCanvasY(y, yMin, yMax));
                ctx.stroke();

                // Y-Achsen Labels
                ctx.fillStyle = '#7f8c8d';
                ctx.font = '11px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(y.toFixed(1), toCanvasX(0, xMax) - 15, toCanvasY(y, yMin, yMax) + 4);
                ctx.textAlign = 'left';
            }
        }

        function drawSeries(seriesKey, n, yMin, yMax) {
            const s = series[seriesKey];

            ctx.strokeStyle = s.color;
            ctx.lineWidth = 2.5;
            ctx.beginPath();

            let started = false;
            for (let i = 1; i <= n; i++) {
                const sum = partialSum(seriesKey, i);
                if (!isNaN(sum) && isFinite(sum)) {
                    const x = toCanvasX(i, n);
                    const y = toCanvasY(sum, yMin, yMax);

                    if (!started) {
                        ctx.moveTo(x, y);
                        started = true;
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
            }
            ctx.stroke();

            // Grenzwert-Linie
            if (s.limit !== null) {
                ctx.strokeStyle = s.color;
                ctx.lineWidth = 1.5;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(toCanvasX(0, n), toCanvasY(s.limit, yMin, yMax));
                ctx.lineTo(toCanvasX(n, n), toCanvasY(s.limit, yMin, yMax));
                ctx.stroke();
                ctx.setLineDash([]);
            }
        }

        function updateLegend() {
            const legendContainer = document.getElementById('legendContainer');
            legendContainer.innerHTML = '';

            Object.keys(series).forEach(key => {
                const checkbox = document.getElementById(`show_${key}`);
                if (checkbox && checkbox.checked) {
                    const s = series[key];
                    const item = document.createElement('div');
                    item.className = 'legend-item';
                    item.innerHTML = `
                        <div class="legend-box" style="background: ${s.color};"></div>
                        <span>${s.name}</span>
                    `;
                    legendContainer.appendChild(item);
                }
            });
        }

        function draw() {
            const n = parseInt(nSlider.value);
            const scaleVal = parseInt(scaleSlider.value);

            nValue.textContent = n;
            scaleValue.textContent = scaleVal === 0 ? 'Auto' : scaleVal;

            // Bestimme aktive Reihen
            const activeSeries = Object.keys(series).filter(key => {
                const checkbox = document.getElementById(`show_${key}`);
                return checkbox && checkbox.checked;
            });

            if (activeSeries.length === 0) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#7f8c8d';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Wähle mindestens eine Reihe aus', canvas.width / 2, canvas.height / 2);
                ctx.textAlign = 'left';
                return;
            }

            // Bestimme y-Bereich
            let yMax = 1;
            let yMin = -0.5;

            if (scaleVal === 0) {
                // Auto-Skalierung
                activeSeries.forEach(key => {
                    const sum = partialSum(key, n);
                    if (isFinite(sum)) {
                        yMax = Math.max(yMax, sum);
                        yMin = Math.min(yMin, sum);
                    }
                });
                yMax = yMax * 1.1;
                yMin = Math.min(yMin * 1.1, -0.2);
            } else {
                yMax = scaleVal;
                yMin = -1;
            }

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawAxes(n, yMin, yMax);

            activeSeries.forEach(key => {
                drawSeries(key, n, yMin, yMax);
            });

            updateLegend();
        }

        function loadExample(type) {
            // Alle deaktivieren
            Object.keys(series).forEach(key => {
                const checkbox = document.getElementById(`show_${key}`);
                if (checkbox) checkbox.checked = false;
            });

            switch(type) {
                case 'all':
                    Object.keys(series).forEach(key => {
                        const checkbox = document.getElementById(`show_${key}`);
                        if (checkbox) checkbox.checked = true;
                    });
                    scaleSlider.value = 0;
                    break;
                case 'harmonic':
                    document.getElementById('show_harmonic').checked = true;
                    document.getElementById('show_alt_harmonic').checked = true;
                    scaleSlider.value = 0;
                    break;
                case 'p-series':
                    document.getElementById('show_p2').checked = true;
                    document.getElementById('show_p3').checked = true;
                    document.getElementById('show_p05').checked = true;
                    scaleSlider.value = 0;
                    break;
                case 'factorial':
                    document.getElementById('show_exp').checked = true;
                    scaleSlider.value = 5;
                    break;
                case 'convergent':
                    Object.keys(series).forEach(key => {
                        if (!series[key].divergent) {
                            const checkbox = document.getElementById(`show_${key}`);
                            if (checkbox) checkbox.checked = true;
                        }
                    });
                    scaleSlider.value = 0;
                    break;
                case 'divergent':
                    Object.keys(series).forEach(key => {
                        if (series[key].divergent) {
                            const checkbox = document.getElementById(`show_${key}`);
                            if (checkbox) checkbox.checked = true;
                        }
                    });
                    scaleSlider.value = 0;
                    break;
            }
            draw();
        }

        nSlider.addEventListener('input', draw);
        scaleSlider.addEventListener('input', draw);

        // Alle Checkboxen
        Object.keys(series).forEach(key => {
            const checkbox = document.getElementById(`show_${key}`);
            if (checkbox) {
                checkbox.addEventListener('change', draw);
            }
        });

        draw();
    </script>
</body>
</html>
